<div class="page page-cart">
    <div class="container">
        <h1 class="page-title">Carrinho de Compras</h1>

        @if (cartService.cartItems().length === 0) {
            <div class="empty-cart">
                <div class="empty-icon">ðŸ›’</div>
                <h2>Seu carrinho estÃ¡ vazio</h2>
                <p>Adicione produtos para comeÃ§ar suas compras</p>
                <a routerLink="/products" class="btn btn-primary">Ver Produtos</a>
            </div>
        } @else {
            <div class="cart-layout">
                <!-- Cart Items -->
                <div class="cart-items">
                    @for (item of cartService.cartItems(); track item.productId + (item.productVariantId || '')) {
                        <div class="cart-item">
                            <div class="item-image">
                                @if (item.imageUrl) {
                                    <img [src]="item.imageUrl" [alt]="item.name" />
                                } @else {
                                    <div class="image-placeholder">
                                        <span>Sem imagem</span>
                                    </div>
                                }
                            </div>

                            <div class="item-details">
                                <h3 class="item-name">{{ item.name }}</h3>
                                <p class="item-sku">SKU: {{ item.sku }}</p>
                                <p class="item-price">{{ formatPrice(item.price) }}</p>
                            </div>

                            <div class="item-quantity">
                                <label>Quantidade:</label>
                                <div class="quantity-controls">
                                    <button
                                        class="btn-quantity"
                                        (click)="
                                            updateQuantity(item.productId, item.productVariantId, item.quantity - 1)
                                        "
                                    >
                                        -
                                    </button>
                                    <input
                                        type="number"
                                        [value]="item.quantity"
                                        (change)="
                                            updateQuantity(
                                                item.productId,
                                                item.productVariantId,
                                                +$any($event.target).value
                                            )
                                        "
                                        min="1"
                                        class="quantity-input"
                                    />
                                    <button
                                        class="btn-quantity"
                                        (click)="
                                            updateQuantity(item.productId, item.productVariantId, item.quantity + 1)
                                        "
                                    >
                                        +
                                    </button>
                                </div>
                            </div>

                            <div class="item-total">
                                <p class="total-label">Total:</p>
                                <p class="total-price">{{ formatPrice(item.price * item.quantity) }}</p>
                            </div>

                            <button
                                class="btn-remove"
                                (click)="removeItem(item.productId, item.productVariantId)"
                                title="Remover item"
                            >
                                Ã—
                            </button>
                        </div>
                    }

                    <div class="cart-actions">
                        <button class="btn btn-secondary" (click)="clearCart()">Limpar Carrinho</button>
                        <a routerLink="/products" class="btn btn-outline"> Continuar Comprando </a>
                    </div>
                </div>

                <!-- Cart Summary -->
                <div class="cart-summary">
                    <h2>Resumo do Pedido</h2>

                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span class="value">{{ formatPrice(cartService.subtotal()) }}</span>
                    </div>

                    <div class="summary-row">
                        <span>Itens:</span>
                        <span class="value">{{ cartService.itemCount() }}</span>
                    </div>

                    <div class="summary-row total">
                        <span>Total:</span>
                        <span class="value">{{ formatPrice(cartService.subtotal()) }}</span>
                    </div>

                    <a routerLink="/checkout" class="btn btn-primary btn-checkout"> Finalizar Compra </a>

                    <div class="security-info">
                        <span class="icon">ðŸ”’</span>
                        <span>Compra 100% segura</span>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
